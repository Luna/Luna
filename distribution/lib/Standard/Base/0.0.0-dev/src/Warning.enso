from Standard.Base import all

type Warning
    type Warning prim_warning

    value = Prim_Warning.get_value this.prim_warning

    origin = Prim_Warning.get_origin this.prim_warning

    reassignments =
        Vector.Vector (Prim_Warning.get_reassignments this.prim_warning) . map r->
            loc = case Polyglot.has_source_location r of
                False -> Nothing
                True -> Source_Location (Polyglot.get_source_location r)
            Stack_Trace_Element (Polyglot.get_executable_name r) loc

attach warning value =
    origin = Runtime.get_stack_trace
    Prim_Warning.attach value warning (origin.drop_start 1)

get_all value =
    Vector.Vector (Prim_Warning.get_all value) . map Warning

set warnings value =
    Prim_Warning.set value (warnings.map .prim_warning).to_array
