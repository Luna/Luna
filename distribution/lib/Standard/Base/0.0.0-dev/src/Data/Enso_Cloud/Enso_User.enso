import project.Data.Text.Text
import project.Data.Enso_Cloud.Utils
import project.Network.HTTP.HTTP
import project.Network.HTTP.HTTP_Method.HTTP_Method

type Enso_User
    ## Represents a user within Enso Cloud.
    User name:Text email:Text id:Text

    ## Fetch the current user.
    current : Enso_User
    current =
        auth_header = Utils.authorization_header
        auth_header.if_not_error <|
            user_api = Utils.cloud_root_uri + "users"
            response = HTTP.fetch user_api HTTP_Method.Get [auth_header]
            response.if_not_error <|
                js_object = response.decode_as_json
                js_object.into Enso_User
