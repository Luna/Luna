from Standard.Base import all

from project.Errors import Unsupported_Database_Operation

## PRIVATE
type Feature
    Select_Columns
    Filter
    Aggregate
    Sort
    Join
    Union
    Distinct
    Text_Cleanse
    Integration_Tests
    Add_Row_Number
    Make_Table_From
    Column_Operations
    Set
    Sample
    Replace
    Merge
    Cross_Join

    if_supported_else_throw self dialect:Any error_name:Text ~action = 
        if dialect.is_feature_supported self then action else
            Error.throw (Unsupported_Database_Operation.Error error_name)
