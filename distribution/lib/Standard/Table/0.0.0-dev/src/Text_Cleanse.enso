from Standard.Base import all
import project.Column.Column

## Defines a Text_Cleanse operation
type Text_Cleanse
   Duplicate_Whitespace
   Leading_Whitespace
   Trailing_Whitespace

   ## Apply the cleanse operation to the text.
   apply self input:Cleansable_Text -> Any =
      case self of
         Text_Cleanse.Leading_Whitespace -> input.replace "^\s+" ""
         Text_Cleanse.Trailing_Whitespace -> input.replace "\s+$" ""
         Text_Cleanse.Duplicate_Whitespace -> input.replace "\s+" ""

## PRIVATE 
   Defines the interface for cleansable object.
type Cleansable_Text
   Value backer

   ## PRIVATE
   replace self pattern:Text replace_with:Text -> Column =
      (self.backer.text_replace (regex pattern) replace_with).rename self.backer.name

   ## PRIVATE
      Cleansable_Text.from (that:Text) = Cleansable_Text.Value that

      ## Extension method to add cleanse to Text.
      Text.cleanse self = 

## PRIVATE
Cleansable_Text.from (that:Column) = Cleansable_Text.Value that

   ##PRIVATE
      Table.text_cleanse... (iterate over columns...)

      Column.text_cleanse...
