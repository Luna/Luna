from Standard.Base import all

polyglot java import org.enso.table.expressions.ExpressionVisitorImpl
polyglot java import java.lang.IllegalArgumentException

type Expression
    For_Column expression:Text

    ## PRIVATE
    evaluate : (Text -> Any) -> (Any -> Any) -> Text -> Text -> Any
    evaluate self getColumn makeConstant moduleName="Standard.Table.Data.Column" typeName="Column" =
        Panic.catch_java IllegalArgumentException handler=(cause-> Error.throw (Expression_Syntax.Error cause.getMessage))
            ExpressionVisitorImpl.evaluate self.expression getColumn makeConstant moduleName typeName

type Expression_Syntax
    Error message:Text

    to_display_text : Text
    to_display_text self = "Expression_Syntax.Error: '" + self.message + "'"