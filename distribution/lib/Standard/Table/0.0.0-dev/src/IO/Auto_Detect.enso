from Standard.Base import Problem_Behavior, Nothing, Error, Panic, Meta, File, Auto_Detect
from Standard.Base.Error.Common import Unsupported_File_Type, Unsupported_File_Type_Data, No_Such_Method_Error_Data, Illegal_Argument_Error_Data

## Add the implementation for the `Table.write` for the `File_Format.Auto_Detect`.
Auto_Detect.write_table : File -> Table -> Existing_File_Behavior -> Match_Columns -> Problem_Behavior -> Nothing
Auto_Detect.write_table self file table on_existing_file match_columns on_problems =
    format = get_format file
    if format == Nothing then Error.throw (Unsupported_File_Type_Data ("No File_Format supports '" + file.extension + "'")) else
        Panic.catch No_Such_Method_Error_Data (format.write_table file table on_existing_file match_columns on_problems) _->
           name = Meta.get_constructor_name (Meta.meta format).constructor
           Error.throw (Illegal_Argument_Error_Data ("Saving a Table as " + name + " is not supported."))