from Standard.Base import all

import Standard.Base.Network.HTTP.Response.Response

import Standard.Test.Extensions
from Standard.Test import Test, Test_Suite

spec =
    ## To run this test locally:
       $ sbt 'http-test-helper/run localhost 8080'
       $ export ENSO_HTTP_TEST_HTTPBIN_URL=http://localhost:8080/
    base_url = Environment.get "ENSO_HTTP_TEST_HTTPBIN_URL"
    pending_has_url = if base_url != Nothing then Nothing else
        "The HTTP tests only run when the `ENSO_HTTP_TEST_HTTPBIN_URL` environment variable is set to URL of the httpbin server"
    base_url_with_slash = base_url.if_not_nothing <|
        if base_url.ends_with "/" then base_url else base_url + "/"

    Test.group "Format Detection in HTTP Fetch" <|


        Test.specify "should detect the encoding from Content-Type in fetch" <|
            ???

        Test.specify "should detect the encoding from Content-Type in decode_as_text" <|
            ???

        Test.specify "should detect the encoding from Content-Type in decode_as_json" <|