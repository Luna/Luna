from Standard.Base import all

from Standard.Base.Data.Text.Text_Sub_Range import all

import Standard.Test

spec = Test.group "Text_Sub_Range.Codepoint_Ranges" <|
    run ranges =
        Codepoint_Ranges ranges False . sorted_and_distinct_ranges
    Test.specify "should be able to sort correctly merge neighboring sequences" <|
        run [] . should_equal []
        run [Range 0 0] . should_equal []
        run [Range 0 10] . should_equal [Range 0 10]
        run [Range 0 10, Range 2 4] . should_equal [Range 0 10]
        run [Range 0 5, Range 5 10] . should_equal [Range 0 10]
        run [Range 5 10, Range 0 0, Range 0 1, Range 1 5] . should_equal [Range 0 10]
        run [Range 0 1, Range 1 2] . should_equal [Range 0 2]
        run [Range 6 7, Range 7 8, Range 5 5, Range 0 1, Range 2 3] . should_equal [Range 0 1, Range 2 3, Range 6 8]
        run [Range 5 10, Range 3 6, Range 3 6, Range 3 5, Range 3 7, Range 0 1] . should_equal [Range 0 1, Range 3 10]
        run [Range 0 1, Range 0 1] . should_equal [Range 0 1]
        run [Range 0 1, Range 1 2] . should_equal [Range 0 2]

main = Test.Suite.run_main spec
