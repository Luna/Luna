from Standard.Base import all

import Standard.Test.Bench

polyglot java import java.util.Random
polyglot java import org.enso.base.Time_Utils


## Bench Utilities ============================================================

vector_size =
num_iterations = 10

make_random_vec : Integer -> Base.Vector.Vector
make_random_vec n =
    random_gen = Random.new n
    Base.Vector.fill n random_gen.nextLong

# The Benchmarks ==============================================================

main =
    random_vec_1 = here.make_random_vec 50000

    Bench.measure (random_vec_1.filter (x -> x % 3 == 1)) "Filter" 20 here.num_iterations

    random_vec_2 = here.make_random_vec 1000000

    stateful_fun x =
       s = State.get Number
       State.put s+x
    Bench.measure (State.run Number 0 <| random_vec_2.each stateful_fun) "Each" 100 here.num_iterations
