from Standard.Base import all
import Standard.Base

from Standard.Test import Bench, Phase_Conf

prep_json size =
    single = '{"foo": 543}, {"bar": false}'
    many = Vector.new size (_ -> single)
    str = "[" + (many.join ",") + "]"
    str

options = Bench.options . set_warmup (Phase_Conf.Seconds 5) . set_measure (Phase_Conf.Seconds 3)

collect_benches = Bench.build builder->
    large_json = prep_json 1000000

    builder.group "Json" options group_builder->
        group_builder.specify "parse_json" <|
            Json.parse large_json

main = collect_benches . run_main
