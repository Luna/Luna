from Standard.Base import all

from Standard.Test_New import all


from project.Common_Table_Operations.Util import run_default_backend


add_specs suite_builder setup =
    prefix = setup.prefix
    table_builder = setup.table_builder

    suite_builder.group prefix+"Temp column" group_builder->
        group_builder.specify "Can generate a temp column" <|
            t1 = table_builder [["X", ['a', 'b']], ["Y", ['c', 'd']], ["Z", [40, 20]]]
            t1.make_temp_column_name . should_equal "temp"

        group_builder.specify "Can generate a temp column without name conflicts" <|
            t1 = table_builder [["X", ['a', 'b']], ["Y", ['c', 'd']], ["temp", [40, 20]]]
            t1.make_temp_column_name . should_equal "temp 1"
