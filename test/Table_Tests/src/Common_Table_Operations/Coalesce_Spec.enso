from Standard.Base import all

from Standard.Table import all hiding Table
from Standard.Table.Errors import all
import Standard.Table.Expression.Expression_Error

import Standard.Database.Internal.IR.SQL_Expression.SQL_Expression
from Standard.Database.Errors import SQL_Error

from Standard.Test import all


from project.Common_Table_Operations.Util import run_default_backend

main filter=Nothing = run_default_backend add_specs filter

add_specs suite_builder setup =
    prefix = setup.prefix
    table_builder = setup.light_table_builder

    suite_builder.group prefix+"Table.coalesce" group_builder->
        group_builder.specify "2 columns passing second as vector" <|
            t = table_builder [["A", [1, 2, Nothing, Nothing]], ["B", [3, Nothing, 4, Nothing]]]
            colA = t.get "A"
            colB = t.get "B"
            result = colA.coalesce [colB]
            result.to_vector . should_equal [1, 2, 4, Nothing]
