from Standard.Base import all

from Standard.Table.Errors import all

from Standard.Test import Test, Problems
import Standard.Test.Extensions

from project.Common_Table_Operations.Util import run_default_backend

main = run_default_backend spec

spec setup =
    prefix = setup.prefix
    table_builder = setup.table_builder
    Test.group prefix+"Column Operations" <|
        Test.specify "iif" <|
            t = table_builder [["X", [True, False, Nothing, True]]]
            t.at "X" . iif 22 33 . to_vector . should_equal [22, 33, Nothing, 22]

        Test.specify "iif on Columns" pending="Not implemented yet." Nothing

        Test.specify "equals_ignore_case" <|
            # TODO test for nothing too
            x = ["a", "B", "c", "DEF", "ę"]
            y = ["ą", "b", "c", "dEf", "Ę"]
            r = [False, True, True, True, True]

            x.zip y (.equals_ignore_case) . should_equal r

            t = table_builder [["X", x], ["Y", y]]
            t.at "X" . equals_ignore_case t.at "Y" . to_vector . should_equal r
